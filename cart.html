<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Queen Dynasty Studio - Cart</title>

  <!-- favicon -->
  <link rel="shortcut icon" href="./favicon.svg" type="image/svg+xml">

  <!-- custom css link -->
  <link rel="stylesheet" href="./assets/css/style.css">

  <!-- google font link -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- preload images -->
  <link rel="preload" as="image" href="./assets/images/logo.png">

  <style>
 
 #cart-items .scrollbar-item {
        width: 200px;  /* Adjust the width as needed */
        height: 400px; /* Adjust the height as needed */
        display: flex;
        justify-content: space-between;
        align-items: center;
        border: 1px solid rgb(242, 156, 190);
        padding: 10px;
        box-sizing: border-box;
    }

    /* Ensure images fit within the fixed size */
    #cart-items .scrollbar-item img {
        max-width: 100%;
        max-height: 60%;
        object-fit: contain;
    }

    /* Ensure other content fits within the fixed size */
    #cart-items .scrollbar-item .card-content {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 100%;
        width: 100%;
        text-align: center;
    }
  </style>
</head>

<body>
  <!-- HEADER -->
  <header class="header">
    <div class="alert" style="color: rgb(0, 0, 0); background-color: rgb(242, 156, 190);">
      <p class="alert-text">Thank you for being with us!!</p>
    </div>
    <div class="header-top" data-header>
      <div class="container">
        <button class="nav-open-btn" aria-label="open menu" data-nav-toggler>
          <span class="line line-1"></span>
          <span class="line line-2"></span>
          <span class="line line-3"></span>
        </button>
        <div class="input-wrapper">
          <input type="search" name="search" class="search-field" style=" border-color: rgb(0, 0, 0); ">
          <button class="search-submit" aria-label="search">
            <ion-icon name="search-outline" aria-hidden="true"
              style="background-color: rgb(0, 0, 0); color: rgb(0, 0, 0);"></ion-icon>
          </button>
        </div>
        <a href="index.html" class="logo">
          <img src="./assets/images/logo.jpg" width="179" height="26" alt="Glowing">
        </a>
        <div class="header-actions">
          <button class="header-action-btn">
            <ion-icon name="person-outline" aria-hidden="true" style="color: rgb(242, 156, 190);"></ion-icon>
          </button>
          <button class="header-action-btn" aria-label="favourite item">
            <ion-icon name="star-outline" aria-hidden="true" style=" color: rgb(242, 156, 190);"></ion-icon>
          </button>
          <button id="theme-toggle" class="header-action-btn" aria-label="cart">
            <a href="cart.html">
              <ion-icon name="cart" aria-hidden="true" style=" color: rgb(242, 156, 190); border-radius: 16;">
              </ion-icon>
            </a>
          </button>
        </div>
        <nav class="navbar">
          <ul class="navbar-list">
            <li><a href="index.html" class="navbar-link has-after" style=" color: rgb(242, 156, 190);">Home</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <!-- CART -->
  <main>
    <section class="section cart" id="cart">
      <div class="container">
        <ul id="cart-items" class="has-scrollbar">
          <!-- Cart items will be dynamically added here -->
        </ul>
        <div>
          <div class="cart-summary">
            <div class="totals">
              <br><br>
              <label>
                <h1><b>Grand Total</b></h1>
              </label>
              <div class="totals-value" id="cart-total"><i><b>0.00</b></i></div>
            </div>
            <br>
           <section>
  <div id="checkout-btn-container" class="text-center" style="margin: 20px;">
    <button id="checkout-btn" class="btn btn-primary" style="background-color: rgb(242, 156, 190); color: rgb(0, 0, 0); padding: 10px 20px; font-size: 16px; border-radius: 5px; ">Checkout</button>
  </div>
</section>

<div id="checkout-form" style="display: none; color: rgb(242, 156, 190); max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ccc; border-radius: 10px; background-color: #000000;">
  <h3 class="h3 section-title" style="color:rgb(242, 156, 190); text-align: center; margin-bottom: 20px;">Checkout Information</h3>
  <form id="checkout-details" style="border-radius: 16px;">
    <div style="margin-bottom: 15px;">
      <label for="name" style="display: block; margin-bottom: 5px;">Name:</label>
      <input type="text" id="name" name="name" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
    </div>

    <div style="margin-bottom: 15px;">
      <label for="email" style="display: block; margin-bottom: 5px;">Email:</label>
      <input type="email" id="email" name="email" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
    </div>

    <div style="margin-bottom: 15px;">
      <label for="phone" style="display: block; margin-bottom: 5px;">Phone Number:</label>
      <input type="tel" id="phone" name="phone" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
    </div>

    <div style="margin-bottom: 15px;">
      <label for="address" style="display: block; margin-bottom: 5px;">Address:</label>
      <input type="text" id="address" name="address" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
    </div>

    <div style="margin-bottom: 15px;">
      <label for="city" style="display: block; margin-bottom: 5px;">City:</label>
      <input type="text" id="city" name="city" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
    </div>

    <div style="margin-bottom: 15px;">
      <label for="state" style="display: block; margin-bottom: 5px;">State:</label>
      <input type="text" id="state" name="state" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
    </div>

    <div style="margin-bottom: 15px;">
      <label for="zip" style="display: block; margin-bottom: 5px;">Zip Code:</label>
      <input type="text" id="zip" name="zip" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
    </div>

    <div style="text-align: center; display: flex; justify-content: center; margin-top: 20px;">
      <button type="submit" class="btn btn-primary" style="background-color: rgb(242, 156, 190); color: white; padding: 10px 20px; font-size: 16px; border-radius: 5px;">Submit</button>
    </div>
    
  </form>
</div>

    </div>
    </main>

    <div id="alert-modal" class="modal">
      <div class="modal-content" style="background-color: #000000; border-color: rgb(242, 156, 190);">
        <p style="color: rgb(255, 255, 255);">Your order has been placed. You will be contacted shortly.</p>
        <button id="modal-ok-btn" style="background-color: rgb(242, 156, 190); color: rgb(0, 0, 0);">OK</button>
      </div>
    </div>

    <div id="cart-empty-modal" class="modal">
      <div class="modal-content" style="background-color: #000000; border-color: rgb(242, 156, 190);">
        <p style="color: rgb(255, 255, 255);">Your cart is empty. Please add items to your cart before checking out.</p>
        <button id="cart-empty-ok-btn" style="background-color: rgb(242, 156, 190); color: rgb(0, 0, 0); ">OK</button>
      </div>
    </div>
  <!-- FOOTER -->
  
  <footer class="footer">
    <div class="waves">
      <div class="wave" id="wave1"></div>
      <div class="wave" id="wave2"></div>
      <div class="wave" id="wave3"></div>
      <div class="wave" id="wave4"></div>
    </div>
    <ul class="social-icon">
      <li class="social-icon__item"><a class="social-icon__link" href="#">
          <ion-icon name="logo-facebook"></ion-icon>
        </a></li>
      <li class="social-icon__item"><a class="social-icon__link" href="#">
          <ion-icon name="logo-twitter"></ion-icon>
        </a></li>
      <li class="social-icon__item"><a class="social-icon__link" href="#">
          <ion-icon name="logo-linkedin"></ion-icon>
        </a></li>
      <li class="social-icon__item"><a class="social-icon__link" href="#">
          <ion-icon name="logo-instagram"></ion-icon>
        </a></li>
    </ul>
    <ul class="menu">
      <li class="menu__item"><a class="menu__link" href="#">Home</a></li>
      <li class="menu__item"><a class="menu__link" href="#">Signup to be a creator </a></li>
      <li class="menu__item"><a class="menu__link" href="#">Shop</a></li>
    </ul>
    <p style="text-align: center; display: flex; justify-content: center; margin-top: 20px;"  >&copy;2024 QDR | All Rights Reserved</p>
  </footer>
  
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
  <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <script type="text/javascript">
    (function () {
      emailjs.init("to52LqUt1QWtFj2cC"); // Replace with your EmailJS user ID
    })();
  </script>
  
  <script>
    function updateCartItemQuantity(productId, quantity) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart = cart.map(item => {
        if (item.id === productId) {
          item.quantity = quantity;
        }
        return item;
      });
      localStorage.setItem('cart', JSON.stringify(cart));
      displayCartItems();
    }
  
    function calculateTotal() {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      let total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
      document.getElementById('cart-total').innerText = `${total.toFixed(2)}`;
    }
  
    function displayCartItems() {
      const cartContainer = document.getElementById('cart-items');
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
  
      cartContainer.innerHTML = ''; // Clear current cart items
  
      cart.forEach(item => {
        const itemElement = document.createElement('li');
        itemElement.classList.add('scrollbar-item');
        itemElement.innerHTML = `
          <div class="shop-card">
            <div class="card-banner img-holder">
              <img src="${item.image}" loading="lazy" alt="${item.name}" class="img-cover">
              <div class="card-actions">
                <button class="action-btn" aria-label="remove from cart" onclick="removeFromCart('${item.id}')">
                  <ion-icon name="trash-outline" aria-hidden="true" style="color: rgb(242, 156, 190);"></ion-icon>
                </button>
              </div>
            </div>
            <div class="card-content">
              <h3><a href="#" class="card-title" style="color: rgb(255, 255, 255);">${item.name}</a></h3>
              <div class="price"><span class="span" style="color: rgb(255, 255, 255);">${item.price}</span></div>
              <div class="quantity">
                <input style="background-color: white; color: black;" type="number" min="1" value="${item.quantity}" onchange="updateCartItemQuantity('${item.id}', this.value)">
              </div>
              <div class="total-price"><span class="span" style="color: rgb(0, 0, 0);"><i><b>${(item.price * item.quantity).toFixed(2)}</i></b></span></div>
            </div>
          </div>
        `;
        cartContainer.appendChild(itemElement);
      });
  
      calculateTotal();
    }
  
    function removeFromCart(productId) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart = cart.filter(item => item.id !== productId);
      localStorage.setItem('cart', JSON.stringify(cart));
      displayCartItems();
    }
  
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('checkout-btn').addEventListener('click', () => {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        if (cart.length === 0) {
          showModal('cart-empty-modal');
          return;
        }
  
        const checkoutForm = document.getElementById('checkout-form');
        checkoutForm.style.display = checkoutForm.style.display === 'none' ? 'block' : 'none';
      });
  
      document.getElementById('checkout-details').addEventListener('submit', (event) => {
        event.preventDefault(); // Prevent default form submission
  
        const name = document.getElementById('name').value;
        const email = document.getElementById('email').value;
        const phone = document.getElementById('phone').value;
        const address = document.getElementById('address').value;
        const city = document.getElementById('city').value;
        const state = document.getElementById('state').value;
        const zip = document.getElementById('zip').value;
  
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
  
        // Prepare email content
        let emailContent =
          `Customer Information:\nName: ${name}\nEmail: ${email}\nPhone: ${phone}\nAddress: ${address}, ${city}, ${state}, ${zip}\n\nProducts:\n`;
  
        cart.forEach(item => {
          emailContent +=
            `Product ID: ${item.id}, Name: ${item.name}, Price: $${item.price}, Quantity: ${item.quantity}\n`;
        });
  
        // Send email using EmailJS
        emailjs.send('service_q7pf937', 'template_1oqbjqe', {
            to_email: 'guanman2020@gmail.com',
            customer_name: name,
            customer_email: email,
            customer_phone: phone,
            customer_address: `${address}, ${city}, ${state}, ${zip}`,
            message: emailContent
          })
          .then((response) => {
            console.log('SUCCESS!', response.status, response.text);
            showModal('alert-modal'); // Show order placed modal
            // Clear the form after submission
            document.getElementById('checkout-details').reset();
            document.getElementById('checkout-form').style.display = 'none';
            localStorage.removeItem('cart');
            displayCartItems();
          }, (error) => {
            console.error('FAILED...', error);
            alert('There was an error sending your order. Please try again.');
          });
      });
  
      document.getElementById('modal-ok-btn').addEventListener('click', () => {
        closeModal('alert-modal');
        window.location.href = "index.html"; // Redirect to home page
      });
  
      document.getElementById('cart-empty-ok-btn').addEventListener('click', () => {
        closeModal('cart-empty-modal');
      });
  
      function showModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.style.display = 'flex';
      }
  
      function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.style.display = 'none';
      }
  
      displayCartItems();
    });
  </script>
  

</body>

</html>